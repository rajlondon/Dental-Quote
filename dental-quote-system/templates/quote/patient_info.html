{% extends 'base.html' %}

{% block title %}Patient Information | MyDentalFly{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-12">
        <h1 class="mb-4">Patient Information</h1>
        <div class="progress mb-4">
            <div class="progress-bar bg-primary" role="progressbar" style="width: 50%;" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100">Step 2 of 4</div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-8">
        <div class="card mb-4">
            <div class="card-header">
                <h2 class="h5 mb-0">Your Information</h2>
            </div>
            <div class="card-body">
                <form action="{{ url_for('page_routes.patient_info') }}" method="POST">
                    <div class="mb-3">
                        <label for="name" class="form-label">Full Name *</label>
                        <input type="text" class="form-control" id="name" name="name" value="{{ patient_info.name }}" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="email" class="form-label">Email Address *</label>
                        <input type="email" class="form-control" id="email" name="email" value="{{ patient_info.email }}" required>
                        <div class="form-text">We'll send your quote to this email address.</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="phone" class="form-label">Phone Number *</label>
                        <input type="tel" class="form-control" id="phone" name="phone" value="{{ patient_info.phone }}" required>
                        <div class="form-text">Include country code (e.g., +44 for UK).</div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="notes" class="form-label">Additional Notes</label>
                        <textarea class="form-control" id="notes" name="notes" rows="4" placeholder="Please share any specific concerns, questions, or requirements you may have.">{{ patient_info.notes }}</textarea>
                    </div>
                    
                    <div class="form-check mb-3">
                        <input class="form-check-input" type="checkbox" id="privacy-policy" required>
                        <label class="form-check-label" for="privacy-policy">
                            I agree to the <a href="#" data-bs-toggle="modal" data-bs-target="#privacyModal">privacy policy</a> and consent to being contacted about my dental treatment.
                        </label>
                    </div>
                    
                    <div class="d-flex justify-content-between">
                        <a href="{{ url_for('page_routes.quote_builder') }}" class="btn btn-outline-secondary">
                            <i class="fas fa-arrow-left me-2"></i> Back to Treatments
                        </a>
                        <button type="submit" class="btn btn-primary">
                            Continue to Review <i class="fas fa-arrow-right ms-2"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-header">
                <h3 class="h5 mb-0">Your Quote Summary</h3>
            </div>
            <div class="card-body">
                <h4 class="mb-3">Selected Treatments</h4>
                <ul class="list-group mb-4">
                    {% for treatment in treatments %}
                    <li class="list-group-item d-flex justify-content-between align-items-center">
                        {{ treatment.name }}
                        <span class="badge bg-primary rounded-pill">${{ treatment.price }}</span>
                    </li>
                    {% endfor %}
                </ul>
                
                {% if promo_code %}
                <div class="alert alert-success mb-4">
                    <p class="mb-0"><strong>{{ promo_code }}</strong> applied!</p>
                    {% if promo_details %}
                        <p class="mb-0 small">{{ promo_details.description }}</p>
                    {% endif %}
                </div>
                {% endif %}
                
                <div class="card bg-light mb-4">
                    <div class="card-body">
                        <div class="d-flex justify-content-between mb-2">
                            <span>Subtotal:</span>
                            <span>${{ subtotal }}</span>
                        </div>
                        {% if discount > 0 %}
                        <div class="d-flex justify-content-between mb-2 text-success">
                            <span>Discount:</span>
                            <span>-${{ discount }}</span>
                        </div>
                        {% endif %}
                        <div class="d-flex justify-content-between fw-bold">
                            <span>Total:</span>
                            <span>${{ total }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Privacy Policy Modal -->
<div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="privacyModalLabel">Privacy Policy</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <h6>Information We Collect</h6>
                <p>We collect personal information that you provide to us, including your name, email address, phone number, and any additional information you share with us regarding your dental treatment requirements.</p>
                
                <h6>How We Use Your Information</h6>
                <p>We use your information to:</p>
                <ul>
                    <li>Generate and provide your dental treatment quote</li>
                    <li>Contact you regarding your quote and treatment options</li>
                    <li>Connect you with appropriate dental clinics in Turkey</li>
                    <li>Assist with travel arrangements if requested</li>
                    <li>Improve our services and customer experience</li>
                </ul>
                
                <h6>Information Sharing</h6>
                <p>We may share your information with our partner dental clinics in Turkey for the purpose of treatment planning and booking. We do not sell your personal information to third parties.</p>
                
                <h6>Data Security</h6>
                <p>We implement appropriate security measures to protect your personal information from unauthorized access, alteration, or disclosure.</p>
                
                <h6>Your Rights</h6>
                <p>You have the right to access, correct, or delete your personal information. You may also withdraw your consent at any time by contacting us.</p>
                
                <h6>Contact Us</h6>
                <p>If you have any questions about our privacy policy, please contact us at privacy@mydentalfly.com.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">I Understand</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}